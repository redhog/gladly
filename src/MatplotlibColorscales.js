import { registerColorscale } from './ColorscaleRegistry.js'

// Generate a GLSL vec4 colorscale_NAME(float t) function from an array of
// [t, r, g, b] stops, using piecewise linear interpolation.
function stopsToGlsl(name, stops) {
  const f = n => n.toFixed(5)
  const lines = [`vec4 colorscale_${name}(float t) {`]
  lines.push('  t = clamp(t, 0.0, 1.0);')
  for (let i = 0; i < stops.length - 1; i++) {
    const [t0, r0, g0, b0] = stops[i]
    const [t1, r1, g1, b1] = stops[i + 1]
    const dt = t1 - t0
    const isLast = i === stops.length - 2
    const cond = isLast ? '' : `if (t < ${f(t1)}) `
    const u = t0 === 0.0 ? `t / ${f(dt)}` : `(t - ${f(t0)}) / ${f(dt)}`
    lines.push(`  ${cond}{ float u = ${u}; return vec4(mix(vec3(${f(r0)},${f(g0)},${f(b0)}), vec3(${f(r1)},${f(g1)},${f(b1)}), u), 1.0); }`)
  }
  lines.push('}')
  return lines.join('\n')
}

function reg(name, stops) {
  registerColorscale(name, stopsToGlsl(name, stops))
}

// ---------------------------------------------------------------------------
// Perceptually uniform sequential
// ---------------------------------------------------------------------------

reg('viridis', [
  [0.000, 0.267004, 0.004874, 0.329415],
  [0.143, 0.278826, 0.175490, 0.483397],
  [0.286, 0.229739, 0.298514, 0.538007],
  [0.429, 0.127568, 0.416500, 0.556627],
  [0.571, 0.134692, 0.518556, 0.553961],
  [0.714, 0.254627, 0.631475, 0.505197],
  [0.857, 0.477504, 0.736353, 0.411248],
  [1.000, 0.993248, 0.906157, 0.143936],
])

reg('plasma', [
  [0.000, 0.050383, 0.029803, 0.527975],
  [0.143, 0.294234, 0.014616, 0.627020],
  [0.286, 0.485386, 0.046929, 0.692000],
  [0.429, 0.641293, 0.107380, 0.664729],
  [0.571, 0.786360, 0.106257, 0.586816],
  [0.714, 0.907296, 0.194860, 0.434610],
  [0.857, 0.975949, 0.393480, 0.217040],
  [1.000, 0.940015, 0.975158, 0.131326],
])

reg('inferno', [
  [0.000, 0.001462, 0.000466, 0.013866],
  [0.143, 0.147607, 0.017520, 0.300290],
  [0.286, 0.369214, 0.039088, 0.428422],
  [0.429, 0.568126, 0.061992, 0.365531],
  [0.571, 0.752886, 0.106243, 0.240952],
  [0.714, 0.900675, 0.222622, 0.068871],
  [0.857, 0.979050, 0.436756, 0.028610],
  [1.000, 0.988362, 0.998364, 0.644924],
])

reg('magma', [
  [0.000, 0.001462, 0.000466, 0.013866],
  [0.143, 0.148115, 0.024918, 0.329770],
  [0.286, 0.337317, 0.062144, 0.463069],
  [0.429, 0.535520, 0.093685, 0.450321],
  [0.571, 0.722817, 0.130003, 0.378004],
  [0.714, 0.899126, 0.216219, 0.287127],
  [0.857, 0.982590, 0.438517, 0.283498],
  [1.000, 0.987053, 0.991438, 0.749504],
])

reg('cividis', [
  [0.000, 0.000000, 0.135112, 0.304751],
  [0.143, 0.076090, 0.198814, 0.381666],
  [0.286, 0.182758, 0.261403, 0.383600],
  [0.429, 0.312613, 0.321020, 0.373000],
  [0.571, 0.467970, 0.389641, 0.347000],
  [0.714, 0.624523, 0.472970, 0.275000],
  [0.857, 0.784988, 0.576130, 0.173810],
  [1.000, 0.995737, 0.909344, 0.000000],
])

// ---------------------------------------------------------------------------
// Sequential single-hue (ColorBrewer)
// ---------------------------------------------------------------------------

reg('Blues', [
  [0.000, 0.968600, 0.984300, 1.000000],
  [0.250, 0.776500, 0.859800, 0.937300],
  [0.500, 0.419600, 0.682400, 0.839200],
  [0.750, 0.129400, 0.443100, 0.709800],
  [1.000, 0.031400, 0.188200, 0.419600],
])

reg('Greens', [
  [0.000, 0.968600, 0.988200, 0.960800],
  [0.250, 0.779600, 0.913700, 0.752900],
  [0.500, 0.454900, 0.768600, 0.462700],
  [0.750, 0.137300, 0.545100, 0.270600],
  [1.000, 0.000000, 0.266700, 0.105900],
])

reg('Reds', [
  [0.000, 1.000000, 0.960800, 0.941200],
  [0.250, 0.988200, 0.733300, 0.631400],
  [0.500, 0.988200, 0.415700, 0.290200],
  [0.750, 0.796100, 0.094100, 0.113700],
  [1.000, 0.403900, 0.000000, 0.050980],
])

reg('Oranges', [
  [0.000, 1.000000, 0.960800, 0.921600],
  [0.250, 0.992200, 0.815700, 0.631400],
  [0.500, 0.992200, 0.631400, 0.325500],
  [0.750, 0.890200, 0.356900, 0.062700],
  [1.000, 0.498000, 0.153000, 0.016000],
])

reg('Purples', [
  [0.000, 0.988200, 0.984300, 0.992200],
  [0.250, 0.843100, 0.843100, 0.901900],
  [0.500, 0.619600, 0.603900, 0.784300],
  [0.750, 0.470600, 0.317600, 0.662700],
  [1.000, 0.247100, 0.000000, 0.490200],
])

reg('Greys', [
  [0.000, 1.000000, 1.000000, 1.000000],
  [1.000, 0.000000, 0.000000, 0.000000],
])

// ---------------------------------------------------------------------------
// Sequential multi-hue (ColorBrewer)
// ---------------------------------------------------------------------------

reg('YlOrBr', [
  [0.000, 1.000000, 1.000000, 0.800000],
  [0.250, 0.996100, 0.890200, 0.564700],
  [0.500, 0.996100, 0.690200, 0.231400],
  [0.750, 0.850900, 0.376500, 0.054900],
  [1.000, 0.400000, 0.145100, 0.023500],
])

reg('YlOrRd', [
  [0.000, 1.000000, 1.000000, 0.800000],
  [0.250, 0.996100, 0.851000, 0.462700],
  [0.500, 0.992200, 0.553000, 0.234900],
  [0.750, 0.890200, 0.101960, 0.109800],
  [1.000, 0.501960, 0.000000, 0.149000],
])

reg('OrRd', [
  [0.000, 1.000000, 0.968600, 0.925500],
  [0.333, 0.992200, 0.729400, 0.517600],
  [0.667, 0.937300, 0.282400, 0.117600],
  [1.000, 0.498000, 0.000000, 0.000000],
])

reg('PuRd', [
  [0.000, 0.968600, 0.956900, 0.976500],
  [0.333, 0.858800, 0.607800, 0.760800],
  [0.667, 0.839200, 0.070600, 0.407800],
  [1.000, 0.403900, 0.000000, 0.121600],
])

reg('RdPu', [
  [0.000, 1.000000, 0.968600, 0.952900],
  [0.333, 0.992200, 0.682400, 0.619600],
  [0.667, 0.862700, 0.200000, 0.490200],
  [1.000, 0.286300, 0.000000, 0.415700],
])

reg('BuPu', [
  [0.000, 0.968600, 0.988200, 0.992200],
  [0.333, 0.560800, 0.780400, 0.862700],
  [0.667, 0.549000, 0.419600, 0.698000],
  [1.000, 0.301960, 0.000000, 0.294100],
])

reg('GnBu', [
  [0.000, 0.968600, 0.988200, 0.941200],
  [0.333, 0.658800, 0.866700, 0.709800],
  [0.667, 0.258800, 0.564700, 0.752900],
  [1.000, 0.031400, 0.113700, 0.345100],
])

reg('PuBu', [
  [0.000, 1.000000, 0.968600, 0.984300],
  [0.333, 0.741200, 0.823500, 0.898000],
  [0.667, 0.239200, 0.600000, 0.741200],
  [1.000, 0.031400, 0.219600, 0.403900],
])

reg('YlGnBu', [
  [0.000, 1.000000, 1.000000, 0.850900],
  [0.250, 0.780400, 0.913700, 0.706000],
  [0.500, 0.254900, 0.713700, 0.768600],
  [0.750, 0.031400, 0.407800, 0.674500],
  [1.000, 0.031400, 0.113700, 0.345100],
])

reg('PuBuGn', [
  [0.000, 1.000000, 0.968600, 0.984300],
  [0.333, 0.713700, 0.811800, 0.901900],
  [0.667, 0.117600, 0.568600, 0.619600],
  [1.000, 0.003900, 0.274500, 0.211800],
])

reg('BuGn', [
  [0.000, 0.968600, 0.988200, 0.992200],
  [0.333, 0.600000, 0.850900, 0.788200],
  [0.667, 0.211800, 0.682400, 0.439200],
  [1.000, 0.000000, 0.266700, 0.105900],
])

reg('YlGn', [
  [0.000, 1.000000, 1.000000, 0.898000],
  [0.333, 0.749000, 0.909800, 0.698000],
  [0.667, 0.407800, 0.741200, 0.388200],
  [1.000, 0.000000, 0.439200, 0.231400],
])

// ---------------------------------------------------------------------------
// Diverging (ColorBrewer + matplotlib)
// ---------------------------------------------------------------------------

reg('PiYG', [
  [0.000, 0.557000, 0.004000, 0.322000],
  [0.250, 0.956000, 0.618000, 0.804000],
  [0.500, 0.969000, 0.969000, 0.969000],
  [0.750, 0.717000, 0.882000, 0.475000],
  [1.000, 0.153000, 0.392000, 0.098000],
])

reg('PRGn', [
  [0.000, 0.251000, 0.000000, 0.294000],
  [0.250, 0.750000, 0.620000, 0.809000],
  [0.500, 0.969000, 0.969000, 0.969000],
  [0.750, 0.580000, 0.831000, 0.549000],
  [1.000, 0.000000, 0.267000, 0.106000],
])

reg('BrBG', [
  [0.000, 0.329000, 0.188000, 0.020000],
  [0.250, 0.812000, 0.612000, 0.302000],
  [0.500, 0.969000, 0.969000, 0.969000],
  [0.750, 0.439000, 0.765000, 0.768000],
  [1.000, 0.000000, 0.235000, 0.188000],
])

reg('PuOr', [
  [0.000, 0.498000, 0.231000, 0.031000],
  [0.250, 0.992000, 0.722000, 0.388000],
  [0.500, 0.969000, 0.969000, 0.969000],
  [0.750, 0.698000, 0.671000, 0.824000],
  [1.000, 0.176000, 0.000000, 0.294000],
])

reg('RdGy', [
  [0.000, 0.404000, 0.000000, 0.122000],
  [0.250, 0.957000, 0.427000, 0.263000],
  [0.500, 1.000000, 1.000000, 1.000000],
  [0.750, 0.729000, 0.729000, 0.729000],
  [1.000, 0.102000, 0.102000, 0.102000],
])

reg('RdBu', [
  [0.000, 0.403000, 0.000000, 0.122000],
  [0.125, 0.698000, 0.093500, 0.168000],
  [0.250, 0.897000, 0.397000, 0.306000],
  [0.375, 0.981000, 0.700000, 0.615000],
  [0.500, 0.969000, 0.969000, 0.969000],
  [0.625, 0.644000, 0.808000, 0.892000],
  [0.750, 0.259000, 0.572000, 0.776000],
  [0.875, 0.129000, 0.358000, 0.556000],
  [1.000, 0.019000, 0.188000, 0.381000],
])

reg('RdYlBu', [
  [0.000, 0.647000, 0.000000, 0.149000],
  [0.250, 0.957000, 0.427000, 0.263000],
  [0.500, 1.000000, 1.000000, 0.749000],
  [0.750, 0.592000, 0.784000, 0.875000],
  [1.000, 0.173000, 0.482000, 0.710000],
])

reg('RdYlGn', [
  [0.000, 0.647000, 0.000000, 0.149000],
  [0.250, 0.957000, 0.427000, 0.263000],
  [0.500, 1.000000, 1.000000, 0.749000],
  [0.750, 0.517000, 0.775000, 0.369000],
  [1.000, 0.000000, 0.408000, 0.216000],
])

reg('Spectral', [
  [0.000, 0.619600, 0.003900, 0.258800],
  [0.200, 0.960800, 0.427500, 0.262700],
  [0.400, 0.996100, 0.878400, 0.545100],
  [0.500, 1.000000, 1.000000, 0.749000],
  [0.600, 0.901900, 0.960800, 0.596100],
  [0.800, 0.400000, 0.760800, 0.647100],
  [1.000, 0.169000, 0.502000, 0.745000],
])

reg('coolwarm', [
  [0.000, 0.229490, 0.298710, 0.753882],
  [0.250, 0.552061, 0.682980, 0.924990],
  [0.500, 0.865003, 0.865003, 0.865003],
  [0.750, 0.956925, 0.581598, 0.490588],
  [1.000, 0.705850, 0.015629, 0.150246],
])

reg('bwr', [
  [0.000, 0.000000, 0.000000, 1.000000],
  [0.500, 1.000000, 1.000000, 1.000000],
  [1.000, 1.000000, 0.000000, 0.000000],
])

reg('seismic', [
  [0.000, 0.000000, 0.000000, 0.300000],
  [0.250, 0.000000, 0.000000, 1.000000],
  [0.500, 1.000000, 1.000000, 1.000000],
  [0.750, 1.000000, 0.000000, 0.000000],
  [1.000, 0.300000, 0.000000, 0.000000],
])

// ---------------------------------------------------------------------------
// Cyclic
// ---------------------------------------------------------------------------

reg('twilight', [
  [0.000, 0.885300, 0.727500, 0.843100],
  [0.125, 0.625000, 0.520000, 0.761000],
  [0.250, 0.318000, 0.222000, 0.523000],
  [0.375, 0.113000, 0.073000, 0.191000],
  [0.500, 0.088000, 0.063000, 0.101000],
  [0.625, 0.282000, 0.095000, 0.101000],
  [0.750, 0.604000, 0.286000, 0.312000],
  [0.875, 0.844000, 0.554000, 0.618000],
  [1.000, 0.885300, 0.727500, 0.843100],
])

reg('twilight_shifted', [
  [0.000, 0.088000, 0.063000, 0.101000],
  [0.125, 0.282000, 0.095000, 0.101000],
  [0.250, 0.604000, 0.286000, 0.312000],
  [0.375, 0.844000, 0.554000, 0.618000],
  [0.500, 0.885300, 0.727500, 0.843100],
  [0.625, 0.625000, 0.520000, 0.761000],
  [0.750, 0.318000, 0.222000, 0.523000],
  [0.875, 0.113000, 0.073000, 0.191000],
  [1.000, 0.088000, 0.063000, 0.101000],
])

reg('hsv', [
  [0.000, 1.000000, 0.000000, 0.000000],
  [0.167, 1.000000, 1.000000, 0.000000],
  [0.333, 0.000000, 1.000000, 0.000000],
  [0.500, 0.000000, 1.000000, 1.000000],
  [0.667, 0.000000, 0.000000, 1.000000],
  [0.833, 1.000000, 0.000000, 1.000000],
  [1.000, 1.000000, 0.000000, 0.000000],
])

// ---------------------------------------------------------------------------
// Sequential misc
// ---------------------------------------------------------------------------

reg('hot', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.375, 1.000000, 0.000000, 0.000000],
  [0.750, 1.000000, 1.000000, 0.000000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('afmhot', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.375, 1.000000, 0.000000, 0.000000],
  [0.750, 1.000000, 1.000000, 0.000000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('gist_heat', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.333, 1.000000, 0.000000, 0.000000],
  [0.667, 1.000000, 0.627000, 0.000000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('copper', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.800, 1.000000, 0.625040, 0.398000],
  [1.000, 1.000000, 0.781200, 0.497500],
])

reg('bone', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.375, 0.329412, 0.329412, 0.455882],
  [0.750, 0.658824, 0.745098, 0.745098],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('pink', [
  [0.000, 0.117647, 0.000000, 0.000000],
  [0.333, 0.651007, 0.437318, 0.437318],
  [0.667, 0.859025, 0.764706, 0.600691],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('spring', [
  [0.000, 1.000000, 0.000000, 1.000000],
  [1.000, 1.000000, 1.000000, 0.000000],
])

reg('summer', [
  [0.000, 0.000000, 0.500000, 0.400000],
  [1.000, 1.000000, 1.000000, 0.400000],
])

reg('autumn', [
  [0.000, 1.000000, 0.000000, 0.000000],
  [1.000, 1.000000, 1.000000, 0.000000],
])

reg('winter', [
  [0.000, 0.000000, 0.000000, 1.000000],
  [1.000, 0.000000, 1.000000, 0.500000],
])

reg('cool', [
  [0.000, 0.000000, 1.000000, 1.000000],
  [1.000, 1.000000, 0.000000, 1.000000],
])

reg('Wistia', [
  [0.000, 0.894100, 1.000000, 0.478400],
  [0.500, 1.000000, 0.893000, 0.090200],
  [1.000, 0.988200, 0.498000, 0.062700],
])

reg('gray', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

// ---------------------------------------------------------------------------
// Misc / complex
// ---------------------------------------------------------------------------

reg('jet', [
  [0.000, 0.000000, 0.000000, 0.500000],
  [0.110, 0.000000, 0.000000, 1.000000],
  [0.375, 0.000000, 1.000000, 1.000000],
  [0.500, 0.500000, 1.000000, 0.500000],
  [0.625, 1.000000, 1.000000, 0.000000],
  [0.890, 1.000000, 0.000000, 0.000000],
  [1.000, 0.500000, 0.000000, 0.000000],
])

reg('turbo', [
  [0.000, 0.189970, 0.071760, 0.232170],
  [0.143, 0.257140, 0.352680, 0.890000],
  [0.286, 0.158430, 0.679520, 0.978190],
  [0.429, 0.000000, 0.930600, 0.684100],
  [0.571, 0.562900, 0.970000, 0.195900],
  [0.714, 0.948980, 0.832000, 0.074020],
  [0.857, 0.984560, 0.487850, 0.075480],
  [1.000, 0.479600, 0.015830, 0.010550],
])

reg('rainbow', [
  [0.000, 0.666700, 0.000000, 1.000000],
  [0.200, 0.000000, 0.000000, 1.000000],
  [0.400, 0.000000, 1.000000, 0.000000],
  [0.600, 1.000000, 1.000000, 0.000000],
  [0.800, 1.000000, 0.500000, 0.000000],
  [1.000, 1.000000, 0.000000, 0.000000],
])

reg('gnuplot', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.250, 0.500000, 0.000000, 0.707000],
  [0.500, 1.000000, 0.000000, 1.000000],
  [0.750, 0.500000, 0.707000, 0.707000],
  [1.000, 0.000000, 1.000000, 0.000000],
])

reg('gnuplot2', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.250, 0.396000, 0.000000, 0.533000],
  [0.500, 0.000000, 0.398000, 1.000000],
  [0.750, 0.000000, 1.000000, 0.866000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('CMRmap', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.250, 0.475000, 0.000000, 0.600000],
  [0.500, 0.900000, 0.370000, 0.000000],
  [0.750, 0.980000, 0.920000, 0.300000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('cubehelix', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.250, 0.236000, 0.157000, 0.421000],
  [0.500, 0.315000, 0.541000, 0.353000],
  [0.750, 0.845000, 0.716000, 0.663000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('nipy_spectral', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.143, 0.467000, 0.000000, 0.533000],
  [0.286, 0.000000, 0.400000, 0.933000],
  [0.429, 0.000000, 0.933000, 0.933000],
  [0.571, 0.000000, 0.800000, 0.000000],
  [0.714, 0.867000, 0.867000, 0.000000],
  [0.857, 1.000000, 0.267000, 0.000000],
  [1.000, 0.800000, 0.800000, 0.800000],
])

reg('gist_rainbow', [
  [0.000, 1.000000, 0.000000, 0.161000],
  [0.167, 1.000000, 1.000000, 0.000000],
  [0.333, 0.000000, 1.000000, 0.000000],
  [0.500, 0.000000, 1.000000, 1.000000],
  [0.667, 0.000000, 0.000000, 1.000000],
  [0.833, 1.000000, 0.000000, 1.000000],
  [1.000, 1.000000, 0.000000, 0.000000],
])

reg('gist_earth', [
  [0.000, 0.000000, 0.000000, 0.000000],
  [0.200, 0.058800, 0.239200, 0.415700],
  [0.400, 0.219600, 0.447100, 0.262700],
  [0.600, 0.576500, 0.600000, 0.337300],
  [0.800, 0.819600, 0.749000, 0.564700],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('terrain', [
  [0.000, 0.200000, 0.200000, 0.600000],
  [0.250, 0.000000, 0.600000, 1.000000],
  [0.500, 0.000000, 0.800000, 0.400000],
  [0.625, 0.537000, 0.741000, 0.153000],
  [0.750, 0.725000, 0.588000, 0.345000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('ocean', [
  [0.000, 0.000000, 0.400000, 0.400000],
  [0.333, 0.000000, 0.000000, 0.800000],
  [0.667, 0.000000, 0.800000, 0.400000],
  [1.000, 1.000000, 1.000000, 1.000000],
])

reg('brg', [
  [0.000, 0.000000, 0.000000, 1.000000],
  [0.500, 1.000000, 0.000000, 0.000000],
  [1.000, 0.000000, 1.000000, 0.000000],
])
